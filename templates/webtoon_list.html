{% extends "base.html" %}
{% block content %}

<div class="container mt-4">
    <center>
        <h4 class="mb-4">ì›¹íˆ° ë¦¬ìŠ¤íŠ¸ ëª©ë¡ ({{ 'ì„±ì¸' if gbun == 'adult' else 'ì¼ë°˜' }})</h4>
    </center>

    <div class="row mb-3 justify-content-center">
        <div class="col-md-10">
            <div class="d-flex gap-2 mb-3 justify-content-center">
                <a href="{{ url_for('webtoon.run_migration') }}" 
                   class="btn btn-dark shadow-sm" 
                   onclick="return confirm('ê¸°ì¡´ webtoon_new.dbì˜ ë°ì´í„°ë¥¼ ìƒˆ ë©€í‹° DBë¡œ ë³µì‚¬í•˜ì‹œê² ìŠµë‹ˆê¹Œ? (ìµœì´ˆ 1íšŒ ê¶Œì¥)')">
                    ğŸ“¦ ê¸°ì¡´ DB ë°ì´í„° ì´ê´€
                </a>
                
                <a href="{{ url_for('webtoon.db_list_reset') }}" 
                   class="btn btn-outline-danger shadow-sm" 
                   onclick="return confirm('ìˆ˜ì§‘ ì§€ì (ID)ê³¼ ë‹¤ìš´ë¡œë“œ ìƒíƒœë¥¼ ì´ˆê¸°í™”í• ê¹Œìš”? ëª©ë¡ì€ ìœ ì§€ë©ë‹ˆë‹¤.')">
                    ğŸ”„ ìˆ˜ì§‘/ìƒíƒœ ì´ˆê¸°í™”
                </a>
            </div>

            <form action="{{ url_for('webtoon.index_list') }}" method="get">
                <input type="hidden" name="gbun" value="{{ gbun }}">
                <div class="input-group">
                    <input type="text" name="search" class="form-control" placeholder="ì›¹íˆ° ì œëª© ê²€ìƒ‰..." value="{{ search or '' }}">
                    <button class="btn btn-primary" type="submit">ê²€ìƒ‰</button>
                    {% if search %}
                    <a href="{{ url_for('webtoon.index_list', gbun=gbun) }}" class="btn btn-outline-secondary">ì´ˆê¸°í™”</a>
                    {% endif %}
                </div>
            </form>
        </div>
    </div>

    <table class="table table-bordered shadow-sm" style="text-align: center;">
        <thead class="table-light">
            <tr>
                <th>ì œëª©</th>
                <th>íšŒì°¨</th>
                <th>ì••ì¶• ì„¤ì •</th>
                <th>í¬ë§·</th>
                <th>ì‘ì—…</th>
            </tr>
        </thead>
        <tbody>
            {% for i in wow %}
            <tr>
                <form action="{{ url_for('webtoon.now_down') }}" method="GET">
                    <input type='hidden' name='gbun' value="{{ gbun }}">
                    <input type="hidden" name="title" value="{{ i['TITLE'] }}">
                    <input type="hidden" name="subtitle" value="{{ i['SUBTITLE'] }}">
                    
                    <td class="align-middle text-start px-3">{{ i['TITLE'] }}</td>
                    <td class="align-middle text-start px-3">{{ i['SUBTITLE'] }}</td>
                    <td class="align-middle">
                        <select name="compress" class="form-select form-select-sm">
                            <option value="0">ì••ì¶•ì‚¬ìš©</option>
                            <option value="1" selected>ì•ˆí•¨</option>
                        </select>
                    </td>
                    <td class="align-middle">
                        <select name="cbz" class="form-select form-select-sm">
                            <option value="0">CBZ</option>
                            <option value="1" selected>ZIP</option>
                        </select>
                    </td>
                    <td class="align-middle">
                        <div class="d-flex gap-1">
                            <input type="submit" class="btn btn-success btn-sm w-100" value="ë‹¤ìš´">
                            <a href="{{ url_for('webtoon.db_redown', title=i['TITLE'], subtitle=i['SUBTITLE'], gbun=gbun) }}" 
                               class="btn btn-outline-warning btn-sm">ğŸ”„</a>
                        </div>
                    </td>
                </form>
            </tr>
            {% else %}
            <tr>
                <td colspan="5" class="py-4 text-muted">ë°ì´í„°ê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <div class="d-flex justify-content-center mt-4 mb-5" style="display: flex !important; justify-content: center;">
    {% if pagination %}
        {{ pagination.links | safe }}
    {% else %}
        <p style="color:red;">í˜ì´ì§• ë°ì´í„°ê°€ ì „ë‹¬ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.</p>
    {% endif %}
    </div>
</div>
{% endblock %}