{% extends "base.html" %}
{% block content %}

<div class="container mt-5 mb-5">
    <div class="card shadow-lg border-0 mx-auto" style="max-width: 800px; border-radius: 20px; overflow: hidden;">
        <div class="card-header py-4 text-center text-dark" style="background: linear-gradient(135deg, #ffca28 0%, #ffb300 100%);">
            <h3 class="fw-bold mb-1"><i class="bi bi-lightbulb-fill me-2"></i> 퀴즈 정답 알림 서비스</h3>
            <p class="mb-0 opacity-75 small fw-bold">키워드 기반 실시간 퀴즈 정답 알림 설정</p>
        </div>

        <div class="card-body p-4 p-md-5 bg-white">
            <form method="POST" id="quizForm">
                <div class="mb-5">
                    <label class="form-label fw-bold text-danger">
                        <i class="bi bi-search me-1"></i> 알림 키워드 입력 (필터)
                    </label>
                    <div class="p-3 bg-danger-subtle rounded-3 mb-3 small text-danger border border-danger-subtle">
                        <i class="bi bi-info-circle-fill me-1"></i> <b>예시:</b> 오퀴즈|캐시워크|캐시닥|타임스프레드|신한|우리|토스
                    </div>
                    <input type="text" class="form-control form-control-lg border-2 shadow-sm rounded-3" name="myalim" 
                           placeholder="키워드를 | 로 구분하여 입력" value="{{ myalim }}">
                </div>

                <div class="card border-0 bg-light rounded-4 p-4 mb-5 border-start border-4 border-warning">
                    <h5 class="fw-bold mb-4 text-dark"><i class="bi bi-telegram me-2"></i>텔레그램 및 알림 제어</h5>
                    <div class="row g-3">
                        <div class="col-md-6">
                            <label class="form-label small fw-bold text-muted">텔레그램 사용 여부</label>
                            <select class="form-select border-2 shadow-sm" name="telgm">
                                <option value="True" {% if telgm == 'True' %}selected{% endif %}>사용함</option>
                                <option value="False" {% if telgm == 'False' %}selected{% endif %}>사용 안함</option>
                            </select>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label small fw-bold text-muted">특정시간 무음 모드</label>
                            <select class="form-select border-2 shadow-sm" name="telgm_alim">
                                <option value="True" {% if telgm_alim == 'True' %}selected{% endif %}>활성화 (설정 시간 무음)</option>
                                <option value="False" {% if telgm_alim == 'False' %}selected{% endif %}>비활성화 (항상 소리 알림)</option>
                            </select>
                        </div>

                        <div class="col-md-12 mt-3">
                            <label class="form-label small fw-bold text-muted">텔레그램 봇 토큰</label>
                            <input type="text" class="form-control border-2 shadow-sm" name="telgm_token" 
                                   placeholder="Bot Token 입력" value="{{ telgm_token }}">
                        </div>
                        <div class="col-md-12 mt-3">
                            <label class="form-label small fw-bold text-muted">텔레그램 봇 ID (Chat ID)</label>
                            <input type="text" class="form-control border-2 shadow-sm" name="telgm_botid" 
                                   placeholder="Chat ID 입력" value="{{ telgm_botid }}">
                        </div>

                        <div class="col-md-6 mt-3">
                            <label class="form-label small fw-bold text-muted"><i class="bi bi-moon-stars-fill me-1"></i> 무음 시작 시간</label>
                            <select class="form-select border-2 shadow-sm" name="start_time2">
                                {% for i in range(0, 24) %}
                                    {% set val = "%02d" % i %}
                                    <option value="{{ val }}" {% if start_time2 == val %}selected{% endif %}>{{ val }}시</option>
                                {% endfor %}
                            </select>
                        </div>
                        <div class="col-md-6 mt-3">
                            <label class="form-label small fw-bold text-muted"><i class="bi bi-sun-fill me-1"></i> 무음 종료 시간</label>
                            <select class="form-select border-2 shadow-sm" name="end_time">
                                {% for i in range(0, 24) %}
                                    {% set val = "%02d" % i %}
                                    <option value="{{ val }}" {% if end_time == val %}selected{% endif %}>{{ val }}시</option>
                                {% endfor %}
                            </select>
                        </div>
                    </div>
                </div>

                <div class="row g-3">
                    <div class="col-md-4 order-2 order-md-1">
                        <button type="button" class="btn btn-light w-100 py-3 fw-bold rounded-pill border" onclick="location.href='/quiz_list';">
                            <i class="bi bi-list-ul me-1"></i> 목록보기
                        </button>
                    </div>
                    <div class="col-md-8 order-1 order-md-2 d-flex gap-2">
                        <button type="submit" class="btn btn-danger flex-grow-1 py-3 fw-bold rounded-pill shadow" onclick="javascript: form.action='/sch_del';">
                            취소/삭제
                        </button>
                        <button type="submit" class="btn btn-warning flex-grow-1 py-3 fw-bold rounded-pill shadow text-dark" onclick="javascript: form.action='/sub2/quiz_ok';">
                            설정 저장 및 실행 <i class="bi bi-check-circle-fill ms-1"></i>
                        </button>
                    </div>
                </div>

                <input type="hidden" name="start_time" value="{{ start_time }}">
                <input type="hidden" name="now" value="True">
                <input type="hidden" name="startname" value="quiz">
            </form>
        </div>
    </div>
</div>

<style>
    body { background-color: #f0f2f5; font-family: 'Pretendard', sans-serif; }
    .form-control:focus, .form-select:focus { border-color: #ffca28; box-shadow: 0 0 0 0.25rem rgba(255, 202, 40, 0.1); }
</style>

{% endblock %}